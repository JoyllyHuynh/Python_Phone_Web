{% extends 'app/base.html' %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'app/css/promotion_list.css' %}">
{% endblock %}

{% block content_promotions %}
<div class="promotions-container">
    <h2 class="promotions-title">üéâ Kho Voucher & ∆Øu ƒë√£i üéâ</h2>

    <div class="row">
        {% for promo in promotions %}
        <div class="col-md-4 mb-4">
            <div class="promo-card">
                <div class="promo-header {% if promo.is_percentage %}promo-header-percentage{% else %}promo-header-fixed{% endif %}">
                    <h3 class="promo-discount">
                        {% if promo.is_percentage %}
                        -{{ promo.discount_value|floatformat:0 }}%
                        {% else %}
                        -{{ promo.discount_value|floatformat:0 }}ƒë
                        {% endif %}
                    </h3>
                    <small class="promo-event-name">{{ promo.event_name }}</small>
                </div>

                <div class="promo-body">
                    <h5 class="promo-code">{{ promo.code }}</h5>
                    <p class="promo-description">{{ promo.description }}</p>

                    <ul class="promo-details">
                        {% if promo.target_products.exists %}
                        <li class="promo-detail-item">
                            <span class="promo-icon">üõí</span> Ch·ªâ √°p d·ª•ng cho m·ªôt s·ªë s·∫£n ph·∫©m
                        </li>
                        {% else %}
                        <li class="promo-detail-item">
                            <span class="promo-icon">üõí</span> √Åp d·ª•ng to√†n s√†n
                        </li>
                        {% endif %}

                        {% if promo.target_users.exists %}
                        <li class="promo-detail-item promo-exclusive">
                            <span class="promo-icon">üëë</span> D√†nh ri√™ng cho b·∫°n!
                        </li>
                        {% endif %}

                        <li class="promo-detail-item">
                            <span class="promo-icon">‚è≥</span> HSD: {{ promo.end_date|date:"d/m/Y" }}
                        </li>
                    </ul>
                </div>

                <div class="promo-footer">
                    <button onclick="copyPromoCode('{{ promo.code }}')" class="btn-copy-code">
                        Sao ch√©p m√£
                    </button>
                </div>
            </div>
        </div>
        {% empty %}
        <div class="col-12">
            <div class="promo-empty-state">
                <p>Hi·ªán t·∫°i ch∆∞a c√≥ khuy·∫øn m√£i n√†o cho b·∫°n. Quay l·∫°i sau nh√©!</p>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<script>
    function copyPromoCode(code) {
        navigator.clipboard.writeText(code).then(function() {
            alert("ƒê√£ sao ch√©p m√£: " + code + ". H√£y nh·∫≠p t·∫°i b∆∞·ªõc thanh to√°n!");
        }).catch(function(err) {
            console.error('Kh√¥ng th·ªÉ sao ch√©p m√£: ', err);
        });
    }
</script>
{% endblock %}